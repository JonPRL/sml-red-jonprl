Thm RecordTypeTest : [
  (record [a : bool] [b : (path {_} bool a a)] [c : bool] [d : S1]) type
] by [
  auto
].

Print RecordTypeTest.

Thm RecordTest0 : [
  tuple in record
] by [
  auto
].

Thm RecordTest1 : [
  (tuple [a tt]) in (record [a : bool])
] by [
  auto;
].

Thm RecordTest2 : [
  (tuple [a tt] [b tuple]) in (record [b : record] [a : bool])
] by [
  auto
].

Thm RecordTest3 : [
  (tuple [a tt] [b ff]) in (record [b a : bool])
] by [
  auto;
].

Thm RecordTest4 : [
  (! a (tuple [a tt] [b ff])) = tt in bool
] by [
  auto;
].

Thm RecordTest5(#p) : [
  #p in record
  >>
  #p = tuple in record
] by [
  auto;
].

Thm RecordTest6 : [
  (->
    [p : (record [a : bool] [b c : record])]
    bool)
] by [
  lam p. `(! a ,p)
].

Thm RecordTest7 : [
  (record
   [a : S1]
   [b : (path {_} S1 a a)])
] by [
  refine record/intro;
  [`base, <i> `(loop i), auto]
].

Def Sg(#a; #b : [exp].exp) = [
  (record
   [pi1 : #a]
   [pi2 : (#b pi1)])
].

Def Fst(#m) = [
  (! pi1 #m)
].

Def Snd(#m) = [
  (! pi2 #m)
].

Thm TestSg : [
  (->
   (Sg nat [x] nat)
   (* nat nat))
] by [
  lam p.
    <`(Fst ,p), `(Snd ,p)>;
].

Print Sg.