Tac CatWfTac{i:lvl} = [
  query gl <- goal.
  match [gl:jdg] {
    [a | #jdg{%a type at {lsucc i}} =>
      let mem : [%a in (univ i)] = auto.
      elim mem; auto
    ]
    [a | #jdg{%a type} =>
      let mem : [%a in (univ i)] = auto.
      elim mem; auto
    ]
    [a | %[a:jdg] => id]
  }
].


Thm Category{i:lvl} : [ (univ {lsucc i}) ] by [
  fresh ob, hom, x, y ->
   `(record
     [ob : (univ i)]
     [hom : (-> ob ob (univ i))]
     [idn : (-> [a : ob] ($ hom a a))]
     [cmp : (-> [a b c : ob] ($ hom b c) ($ hom a b) ($ hom a c))]
     [idn/l :
      (->
       [a b : ob]
       [f : ($ hom a b)]
       (=
        ($ hom a b)
        ($ cmp a b b ($ idn b) f)
        f))]
     [idn/r :
      (->
       [a b : ob]
       [f : ($ hom a b)]
       (=
        ($ hom a b)
        ($ cmp a a b f ($ idn a))
        f))]); // fill in the rest, but this suffices as an example

  {CatWfTac i}
].

Print Category.
